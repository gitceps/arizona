!function(e){"use strict";function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return e instanceof Function}function n(e){return!i(e)&&e instanceof Object}function s(e,i){var a;for(a in i)n(i[a])||t(i[a])?(n(i[a])&&!n(e[a])&&(e[a]={}),t(i[a])&&!t(e[a])&&(e[a]=[]),s(e[a],i[a])):void 0!==i[a]&&(e[a]=i[a])}function a(e,t){var i={};return s(i,e),s(i,t),i}function r(e){var t,i,n,s,a,r,o,l,u,h,d;return h=Object.prototype.toString.call(e),"[object Date]"===h?e:"[object String]"===h?(n=e.match(Y),n?(d=parseInt(n[1],10),r=parseInt(n[3],10)-1,t=parseInt(n[5],10),i=parseInt(n[7],10),a=n[9]?parseInt(n[9],10):0,u=n[11]?parseInt(n[11],10):0,s=n[12]?1e3*parseFloat(G+n[12].slice(1)):0,l=Date.UTC(d,r,t,i,a,u,s),n[13]&&n[14]&&(o=60*n[15],n[17]&&(o+=parseInt(n[17],10)),o*="-"===n[14]?-1:1,l-=60*o*1e3),new Date(l)):void 0):void 0}function o(e){var t,i,n;for(t=0;t<e.length;t++)for(n=e[t].data,i=0;i<n.length;i++)if(n[i][1]<0)return!0;return!1}function l(e,t,i,n,s,r,l){return function(u,h,d){var c=a({},e);return c=a(c,d||{}),h.hideLegend&&t(c),"min"in h?i(c,h.min):o(u)||i(c,0),h.max&&n(c,h.max),"stacked"in h&&s(c,h.stacked),h.colors&&(c.colors=h.colors),h.xtitle&&r(c,h.xtitle),h.ytitle&&l(c,h.ytitle),c=a(c,h.library||{})}}function u(e,t){document.body.innerText?e.innerText=t:e.textContent=t}function h(e,t){u(e,"Error Loading Chart: "+t),e.style.color="#ff0000"}function d(t,i,n){var s=e.jQuery||e.Zepto||e.$;s.ajax({dataType:"json",url:i,success:n,error:function(e,i,n){var s="string"==typeof n?n:n.message;h(t,s)}})}function c(e,t){try{t(e)}catch(t){throw h(e.element,t.message),t}}function p(e,t){"string"==typeof e.dataSource?d(e.element,e.dataSource,function(i){e.data=i,c(e,t)}):(e.data=e.dataSource,c(e,t))}function f(e){return""+e}function m(e){return parseFloat(e)}function g(e){var t,i,n,s;if("object"!=typeof e)if("number"==typeof e)e=new Date(1e3*e);else{if(t=e.match(Q))return i=parseInt(t[1],10),n=parseInt(t[3],10)-1,s=parseInt(t[5],10),new Date(i,n,s);var a=e.replace(/ /,"T").replace(" ","").replace("UTC","Z");e=r(a)||new Date(e)}return e}function v(e){if(!t(e)){var i,n=[];for(i in e)e.hasOwnProperty(i)&&n.push([i,e[i]]);e=n}return e}function y(e,t){return e[0].getTime()-t[0].getTime()}function b(e,t){return e-t}function w(){!X&&"Highcharts"in e&&(X=new function(){var t=e.Highcharts;this.name="highcharts";var i={chart:{},xAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},yAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},title:{text:null},credits:{enabled:!1},legend:{borderWidth:0},tooltip:{style:{fontSize:"12px"}},plotOptions:{areaspline:{},series:{marker:{}}}},n=function(e){e.legend.enabled=!1},s=function(e,t){e.yAxis.min=t},r=function(e,t){e.yAxis.max=t},o=function(e,t){e.plotOptions.series.stacking=t?"normal":null},u=function(e,t){e.xAxis.title.text=t},h=function(e,t){e.yAxis.title.text=t},d=l(i,n,s,r,o,u,h);this.renderLineChart=function(e,i){i=i||"spline";var n={};"areaspline"===i&&(n={plotOptions:{areaspline:{stacking:"normal"},series:{marker:{enabled:!1}}}});var s,a,r,o=d(e.data,e.options,n);o.xAxis.type=e.options.discrete?"category":"datetime",o.chart.type=i,o.chart.renderTo=e.element.id;var l=e.data;for(a=0;a<l.length;a++){if(s=l[a].data,!e.options.discrete)for(r=0;r<s.length;r++)s[r][0]=s[r][0].getTime();l[a].marker={symbol:"circle"}}o.series=l,new t.Chart(o)},this.renderScatterChart=function(e){var i={},n=d(e.data,e.options,i);n.chart.type="scatter",n.chart.renderTo=e.element.id,n.series=e.data,new t.Chart(n)},this.renderPieChart=function(e){var n={};e.options.colors&&(n.colors=e.options.colors);var s=a(a(i,n),e.options.library||{});s.chart.renderTo=e.element.id,s.series=[{type:"pie",name:e.options.label||"Value",data:e.data}],new t.Chart(s)},this.renderColumnChart=function(e,i){i=i||"column";var n,s,a,r,o=e.data,l=d(o,e.options),u=[];for(l.chart.type=i,l.chart.renderTo=e.element.id,n=0;n<o.length;n++)for(a=o[n],s=0;s<a.data.length;s++)r=a.data[s],u[r[0]]||(u[r[0]]=new Array(o.length)),u[r[0]][n]=r[1];var h=[];for(n in u)u.hasOwnProperty(n)&&h.push(n);l.xAxis.categories=h;var c=[];for(n=0;n<o.length;n++){for(r=[],s=0;s<h.length;s++)r.push(u[h[s]][n]||0);c.push({name:o[n].name,data:r})}l.series=c,new t.Chart(l)};var c=this;this.renderBarChart=function(e){c.renderColumnChart(e,"bar")},this.renderAreaChart=function(e){c.renderLineChart(e,"areaspline")}},$.push(X)),!V&&e.google&&e.google.setOnLoadCallback&&(V=new function(){var t=e.google;this.name="google";var i={},n=[],s=function(){for(var e,i,s=0;s<n.length;s++)e=n[s],i=t.visualization&&("corechart"===e.pack&&t.visualization.LineChart||"timeline"===e.pack&&t.visualization.Timeline),i&&(e.callback(),n.splice(s,1),s--)},r=function(e,a){if(a||(a=e,e="corechart"),n.push({pack:e,callback:a}),i[e])s();else{i[e]=!0;var r={packages:[e],callback:s};U.language&&(r.language=U.language),t.load("visualization","1",r)}},o={chartArea:{},fontName:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",pointSize:6,legend:{textStyle:{fontSize:12,color:"#444"},alignment:"center",position:"right"},curveType:"function",hAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},gridlines:{color:"transparent"},baselineColor:"#ccc",viewWindow:{}},vAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},baselineColor:"#ccc",viewWindow:{}},tooltip:{textStyle:{color:"#666",fontSize:12}}},u=function(e){e.legend.position="none"},h=function(e,t){e.vAxis.viewWindow.min=t},d=function(e,t){e.vAxis.viewWindow.max=t},c=function(e,t){e.hAxis.viewWindow.min=t},p=function(e,t){e.hAxis.viewWindow.max=t},f=function(e,t){e.isStacked=!!t},g=function(e,t){e.hAxis.title=t,e.hAxis.titleTextStyle.italic=!1},v=function(e,t){e.vAxis.title=t,e.vAxis.titleTextStyle.italic=!1},b=l(o,u,h,d,f,g,v),w=function(e,i){var n,s,a,r,o,l=[];for(n=0;n<e.length;n++)for(a=e[n],s=0;s<a.data.length;s++)r=a.data[s],o="datetime"===i?r[0].getTime():r[0],l[o]||(l[o]=new Array(e.length)),l[o][n]=m(r[1]);var u,h=[],d=!0;for(n in l)l.hasOwnProperty(n)&&("datetime"===i?(u=new Date(m(n)),d=d&&T(u)):u="number"===i?m(n):n,h.push([u].concat(l[n])));"datetime"===i&&h.sort(y);var c=new t.visualization.DataTable;for(i="datetime"===i&&d?"date":i,c.addColumn(i,""),n=0;n<e.length;n++)c.addColumn("number",e[n].name);return c.addRows(h),c},x=function(t){e.attachEvent?e.attachEvent("onresize",t):e.addEventListener&&e.addEventListener("resize",t,!0),t()};this.renderLineChart=function(e){r(function(){var i=b(e.data,e.options),n=w(e.data,e.options.discrete?"string":"datetime");e.chart=new t.visualization.LineChart(e.element),x(function(){e.chart.draw(n,i)})})},this.renderPieChart=function(e){r(function(){var i={chartArea:{top:"10%",height:"80%"}};e.options.colors&&(i.colors=e.options.colors);var n=a(a(o,i),e.options.library||{}),s=new t.visualization.DataTable;s.addColumn("string",""),s.addColumn("number","Value"),s.addRows(e.data),e.chart=new t.visualization.PieChart(e.element),x(function(){e.chart.draw(s,n)})})},this.renderColumnChart=function(e){r(function(){var i=b(e.data,e.options),n=w(e.data,"string");e.chart=new t.visualization.ColumnChart(e.element),x(function(){e.chart.draw(n,i)})})},this.renderBarChart=function(e){r(function(){var i={hAxis:{gridlines:{color:"#ccc"}}},n=l(o,u,c,p,f,g,v)(e.data,e.options,i),s=w(e.data,"string");e.chart=new t.visualization.BarChart(e.element),x(function(){e.chart.draw(s,n)})})},this.renderAreaChart=function(e){r(function(){var i={isStacked:!0,pointSize:0,areaOpacity:.5},n=b(e.data,e.options,i),s=w(e.data,e.options.discrete?"string":"datetime");e.chart=new t.visualization.AreaChart(e.element),x(function(){e.chart.draw(s,n)})})},this.renderGeoChart=function(e){r(function(){var i={legend:"none",colorAxis:{colors:e.options.colors||["#f6c7b6","#ce502d"]}},n=a(a(o,i),e.options.library||{}),s=new t.visualization.DataTable;s.addColumn("string",""),s.addColumn("number",e.options.label||"Value"),s.addRows(e.data),e.chart=new t.visualization.GeoChart(e.element),x(function(){e.chart.draw(s,n)})})},this.renderScatterChart=function(e){r(function(){var i={},n=b(e.data,e.options,i),s=w(e.data,"number");e.chart=new t.visualization.ScatterChart(e.element),x(function(){e.chart.draw(s,n)})})},this.renderTimeline=function(e){r("timeline",function(){var i={legend:"none"};e.options.colors&&(i.colors=e.options.colors);var n=a(a(o,i),e.options.library||{}),s=new t.visualization.DataTable;s.addColumn({type:"string",id:"Name"}),s.addColumn({type:"date",id:"Start"}),s.addColumn({type:"date",id:"End"}),s.addRows(e.data),e.element.style.lineHeight="normal",e.chart=new t.visualization.Timeline(e.element),x(function(){e.chart.draw(s,n)})})}},$.push(V)),!K&&"Chart"in e&&(K=new function(){var t=e.Chart;this.name="chartjs";var i={maintainAspectRatio:!1,animation:!1},n={scales:{yAxes:[{ticks:{maxTicksLimit:4},scaleLabel:{fontSize:16,fontColor:"#333"}}],xAxes:[{gridLines:{drawOnChartArea:!1},scaleLabel:{fontSize:16,fontColor:"#333"},time:{},ticks:{}}]},legend:{}},s=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],r=function(e){e.legend.display=!1},o=function(e,t){null!==t&&(e.scales.yAxes[0].ticks.min=t)},u=function(e,t){e.scales.yAxes[0].ticks.max=t},h=function(e,t){null!==t&&(e.scales.xAxes[0].ticks.min=t)},d=function(e,t){e.scales.xAxes[0].ticks.max=t},c=function(e,t){e.scales.xAxes[0].stacked=!!t,e.scales.yAxes[0].stacked=!!t},p=function(e,t){e.scales.xAxes[0].scaleLabel.display=!0,e.scales.xAxes[0].scaleLabel.labelString=t},g=function(e,t){e.scales.yAxes[0].scaleLabel.display=!0,e.scales.yAxes[0].scaleLabel.labelString=t},v=function(e,i,n,s){e.element.innerHTML="<canvas></canvas>";var a=e.element.getElementsByTagName("CANVAS")[0];e.chart=new t(a,{type:i,data:n,options:s})},y=function(e,t){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?"rgba("+parseInt(i[1],16)+", "+parseInt(i[2],16)+", "+parseInt(i[3],16)+", "+t+")":e},w=function(e,t,i){var n=Math.ceil(e.element.offsetWidth/4/t.labels.length);n>25&&(n=25),i.scales.xAxes[0].ticks.callback=function(e){return e=f(e),e.length>n?e.substring(0,n-2)+"...":e}},x=l(a(i,n),r,o,u,c,p,g),D=function(e,t,i){var n,r,o,l,u,h,d=[],c=[],p=e.options.colors||s,f=!0,g=!0,v=!0,w=!0,x=!0,D=!0,P=("line"===i||"area"===i)&&!e.options.discrete,M=e.data,I=[],A=[];for(r=0;r<M.length;r++)for(l=M[r],o=0;o<l.data.length;o++)u=l.data[o],h=P?u[0].getTime():u[0],A[h]||(A[h]=new Array(M.length)),A[h][r]=m(u[1]),I.indexOf(h)===-1&&I.push(h);P&&I.sort(b);var z=[];for(o=0;o<M.length;o++)z.push([]);var N,L;for(L=0;L<I.length;L++)for(r=I[L],P?(N=new Date(m(r)),f=f&&T(N),n||(n=N.getDay()),g=g&&S(N,n),v=v&&k(N),w=w&&E(N),x=x&&C(N),D=D&&_(N)):N=r,c.push(N),o=0;o<M.length;o++)z[o].push(A[r][o]);for(r=0;r<M.length;r++){l=M[r];var H="line"!==i?y(p[r],.5):p[r],O={label:l.name,data:z[r],fill:"area"===i,borderColor:p[r],backgroundColor:H,pointBackgroundColor:p[r],borderWidth:2};d.push(a(O,l.library||{}))}if(P&&c.length>0){var B=c[0].getTime(),R=c[0].getTime();for(r=1;r<c.length;r++)N=c[r].getTime(),N<B&&(B=N),N>R&&(R=N);var W=(R-B)/864e5;if(!t.scales.xAxes[0].time.unit){var F;if(w||W>3650?(t.scales.xAxes[0].time.unit="year",F=365):v||W>300?(t.scales.xAxes[0].time.unit="month",F=30):f||W>10?(t.scales.xAxes[0].time.unit="day",F=1):x?(t.scales.xAxes[0].time.unit="hour",F=1/24):D&&(t.scales.xAxes[0].time.displayFormats={minute:"h:mm a"},t.scales.xAxes[0].time.unit="minute",F=1/24/60),F&&W>0){var j=Math.ceil(W/F/(e.element.offsetWidth/100));g&&1===F&&(j=7*Math.ceil(j/7)),t.scales.xAxes[0].time.unitStepSize=j}}t.scales.xAxes[0].time.tooltipFormat||(f?t.scales.xAxes[0].time.tooltipFormat="ll":x?t.scales.xAxes[0].time.tooltipFormat="MMM D, h a":D&&(t.scales.xAxes[0].time.tooltipFormat="h:mm a"))}var q={labels:c,datasets:d};return q};this.renderLineChart=function(e,t){var i={};!e.options.max&&P(e.data)&&(e.options.max=1);var n=x(e.data,a(i,e.options)),s=D(e,n,t||"line");n.scales.xAxes[0].type=e.options.discrete?"category":"time",v(e,"line",s,n)},this.renderPieChart=function(e){for(var t=a(i,e.options.library||{}),n=[],r=[],o=0;o<e.data.length;o++){var l=e.data[o];n.push(l[0]),r.push(l[1])}var u={labels:n,datasets:[{data:r,backgroundColor:e.options.colors||s}]};v(e,"pie",u,t)},this.renderColumnChart=function(e,t){var s;s="bar"===t?l(a(i,n),r,h,d,c,p,g)(e.data,e.options):x(e.data,e.options);var o=D(e,s,"column");w(e,o,s),v(e,"bar"===t?"horizontalBar":"bar",o,s)};var M=this;this.renderAreaChart=function(e){M.renderLineChart(e,"area")},this.renderBarChart=function(e){M.renderColumnChart(e,"bar")}},$.unshift(K))}function x(e,t){var n,s,a,r;for(a="render"+e,r=t.options.adapter,w(),n=0;n<$.length;n++)if(s=$[n],(!r||r===s.name)&&i(s[a]))return s[a](t);throw new Error("No adapter found")}function _(e){return 0===e.getMilliseconds()&&0===e.getSeconds()}function C(e){return _(e)&&0===e.getMinutes()}function T(e){return C(e)&&0===e.getHours()}function S(e,t){return T(e)&&e.getDay()===t}function k(e){return T(e)&&1===e.getDate()}function E(e){return k(e)&&0===e.getMonth()}function D(e){return!isNaN(g(e))&&f(e).length>=6}function P(e){var t,i,n;for(t=0;t<e.length;t++)for(n=e[t].data,i=0;i<n.length;i++)if(0!=n[i][1])return!1;return!0}function M(e){var t,i,n;for(t=0;t<e.length;t++)for(n=v(e[t].data),i=0;i<n.length;i++)if(!D(n[i][0]))return!0;return!1}function I(e,i,n){var s;for(!t(e)||"object"!=typeof e[0]||t(e[0])?(e=[{name:i.label||"Value",data:e}],i.hideLegend=!0):i.hideLegend=!1,null!==i.discrete&&void 0!==i.discrete||(i.discrete=M(e)),i.discrete&&(n="string"),s=0;s<e.length;s++)e[s].data=Z(v(e[s].data),n);return e}function A(e){var t,i=v(e);for(t=0;t<i.length;t++)i[t]=[f(i[t][0]),m(i[t][1])];return i}function z(e){var t;for(t=0;t<e.length;t++)e[t][1]=g(e[t][1]),e[t][2]=g(e[t][2]);return e}function N(e){e.data=I(e.data,e.options,"datetime"),x("LineChart",e)}function L(e){e.data=I(e.data,e.options,"string"),x("ColumnChart",e)}function H(e){e.data=A(e.data),x("PieChart",e)}function O(e){e.data=I(e.data,e.options,"string"),x("BarChart",e)}function B(e){e.data=I(e.data,e.options,"datetime"),x("AreaChart",e)}function R(e){e.data=A(e.data),x("GeoChart",e)}function W(e){e.data=I(e.data,e.options,"number"),x("ScatterChart",e)}function F(e){e.data=z(e.data),x("Timeline",e)}function j(e,t,i,n,s){var a;if("string"==typeof t&&(a=t,t=document.getElementById(t),!t))throw new Error("No element with id "+a);e.element=t,e.options=n||{},e.dataSource=i,e.getElement=function(){return t},e.getData=function(){return e.data},e.getOptions=function(){return n||{}},e.getChartObject=function(){return e.chart},q.charts[t.id]=e,p(e,s)}var q,Y,G,V,X,K,U=e.Chartkick||{},$=[],Q=/^(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)$/i;Y=/(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)(T)?(\d\d)(:)?(\d\d)?(:)?(\d\d)?([\.,]\d+)?($|Z|([\+\-])(\d\d)(:)?(\d\d)?)/i,G=String(1.5).charAt(1);var J=function(e,t){return e="number"===t?m(e):"datetime"===t?g(e):f(e)},Z=function(e,t){var i,n,s=[];for(n=0;n<e.length;n++)i=J(e[n][0],t),s.push([i,m(e[n][1])]);return"datetime"===t&&s.sort(y),s};q={LineChart:function(e,t,i){j(this,e,t,i,N)},PieChart:function(e,t,i){j(this,e,t,i,H)},ColumnChart:function(e,t,i){j(this,e,t,i,L)},BarChart:function(e,t,i){j(this,e,t,i,O)},AreaChart:function(e,t,i){j(this,e,t,i,B)},GeoChart:function(e,t,i){j(this,e,t,i,R)},ScatterChart:function(e,t,i){j(this,e,t,i,W)},Timeline:function(e,t,i){j(this,e,t,i,F)},charts:{}},"object"==typeof module&&"object"==typeof module.exports?module.exports=q:e.Chartkick=q}(window);